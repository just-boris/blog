---
layout: post
title: Запросы к Github API из Angular
tags: [angular, github]
---
Компания Twitter активно выкладывает свои разрабтки в сеть и это не может не радовать. Ведь все любят [Bootstrap](http://twitter.github.io/bootstrap/) и [Bower](http://bower.io/)? Но на этом классные штуки не кончаются, и на их все можно посмотреть на странице [Twitter ♥ Open Source](http://twitter.github.io/). Очень странно, что такая страница есть только у них, ведь что может быть прекраснее чем автоматически составляемый список опубликованных проектов, оформленный в собственном стиле? Именно поэтому я захотел себе такой же.

В twitter этот список строится крайне очевидным путем на jQuery без каких-либо дополнительных библиотек. Но так писать - это не путь для настоящего джедая. Ведь для такой типовой задачи, как забрать данные с сервера и оформить их в html есть инструменты в каждом фреймоворке. Мой любимый, а в последнее время и не только мой, - это angular.js, поэтому на нем и напишем. Angular - это MVC фреймворк со своим шаблонизатором, связыванием данных и представления через dirty-check, и множеством отдельных компонентов для облегчения нелегких будней веб-разработки.

Путь решения нашей задачи будет такой:

1. Запрашиваем через [GitHub API](http://developer.github.com/v3/repos/#list-user-repositories) и список моих репозиториев
2. Результат сохраним в модель 
3. А в представлении опишем шаблон вывода нашего списка

После преобразования русских букв в javascript, мы получим код нашего контроллера:
{% highlight javascript %}
angular.module('homeApp', []).controller('repoController', function($scope, $http) {
	//загружаем список и кладем его в scope
	$http.get('https://api.github.com/users/just-boris/repos')
	.then(function(response) {
		$scope.repos = response.data
	});
	//функция для проверки наличия страницы в репозитории
	$scope.hasHomepage = function(repo) {
		return repo.homepage !== null && repo.homepage !== "";
	}
});
{% endhighlight %}

Какого-то особого интерактива в этом примере нет, поэтому и код получился небольшим. Основные действия по представлению данных будем производить в шаблоне.

{% highlight html %}
<!-- любые действия в angular начинаются с контроллера, вот и он -->
<div ng-controller="repoController" class="container">
	<h3>Hello! There are my repositories:</h3>
	<!-- здесь запускается итератор по списку, этот узел 
	     будет клонироваться вместе с содержимым -->
	<div class="row" ng-repeat="repo in repos">
		<h5>
			<!-- а здесь ветвление, название оформляется ссылкой, если она есть -->
			<ng-switch on="hasHomepage(repo)">
				<a ng-switch-when="true" ng-href="/{{repo.name}}">{{repo.name}}</a>
				<span ng-switch-when="false">{{repo.name}}</span>
			</ng-switch>
			<small>(<a href="{{repo.html_url}}">repo</a>)</small>
		</h5>
		<p class="muted">
			<!-- это условие проще, его можно оформить в виде show/hide -->
			<img ng-show="repo.fork" src="img/fork.png" 
				class="fork icon" title="Forked repository"/>
		 	{{repo.description}}
	 	</p>
	</div>
</div>
{% endhighlight %}

[Демо-страница](/)

Ну вот и получилось, что основную работу за нас выполнил сам фреймворк. Нам не пришлось изобретать велосипеды, для всего нашелся готовый подходящий сервис. С версткой тоже проблем не возникло, все достаточно просто описывается, можно легко двигать элементы, наша схема не использует селекторов для выбора каких-то конктретных элементов, потому что нам не нужно путешествовать по DOM, каждая его часть делает свою задачу, и делает ее хорошо.

Для любителей чего-то необычного есть версия такой же странице на другом фреймворке, не таком популярном - на [BasisJS](basisjs.com). [Посмотрите](http://catatron.com/ru/), вдруг тоже понравится. Сама идея построения такого списка на js - неплохой тест-драйв для любой frontend-библиотеки, вроде написания [TodoMVC](http://todomvc.com/), он позволяет найти слабости и разобраться в основах использования новой неведомой штуки.

**Bonus.** А вы знали, что случится, если нажать на лого twitter, на их демо-странице?